(this.webpackJsonpsplat=this.webpackJsonpsplat||[]).push([[0],{26:function(e,t,n){e.exports=n(47)},31:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),u=n.n(o),c=(n(31),n(21)),l=n(25),s=n(4),i=n.n(s),d=n(9),p=n(5),m=n(1),b=n(22),h=n.n(b),f=n(15),v=n(23),g=n.n(v),E=function(){var e,t,n,o=null!==(e=null===(t=Object(p.useAuth)())||void 0===t||null===(n=t.userData)||void 0===n?void 0:n.access_token)&&void 0!==e?e:null,u=Object(a.useRef)(new h.a),s=Object(a.useRef)();u.current.setAccessToken(o);var m=Object(f.b)("current-playing",Object(d.a)(i.a.mark((function e(){var t,n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.current.getMyCurrentPlaybackState();case 2:return r=e.sent,e.abrupt("return",{album:null===(t=r.item)||void 0===t?void 0:t.album.id,song:null===(n=r.item)||void 0===n?void 0:n.id,pos:null===(a=r.item)||void 0===a?void 0:a.track_number});case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:1e4,enabled:u.current.getAccessToken()}),b=m.data,v=m.error,g=Object(f.a)(function(){var e=Object(d.a)(i.a.mark((function e(t){var n,a,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.current.getAlbumTracks(t,{limit:50,offset:1});case 2:n=e.sent,a=Object(c.a)(n.items),e.prev=4,a.s();case 6:if((r=a.n()).done){e.next=12;break}return o=r.value,e.next=10,u.current.queue(o.uri);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()),E=Object(l.a)(g,2),k=E[0],O=E[1];return Object(a.useEffect)((function(){Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.current!==(null===b||void 0===b?void 0:b.album)&&(null===b||void 0===b?void 0:b.album)&&1===(null===b||void 0===b?void 0:b.pos)&&k(null===b||void 0===b?void 0:b.album),s.current=null===b||void 0===b?void 0:b.album;case 2:case"end":return e.stop()}}),e)})))()}),[k,b]),r.a.createElement("div",null,r.a.createElement("h1",null,"Dashboard"),O.isLoading&&"enqueueing songs",v?"ERROR: "+JSON.parse(v.response).error.message:"TODO put something status-y here")},k=function(){var e=Object(p.useAuth)(),t=e.signIn,n=e.userData,a=Object(m.e)();return r.a.createElement("div",null,r.a.createElement(g.a,{href:"https://github.com/Briaoeuidhtns/splat",bannerColor:"#1DB954"}),r.a.createElement("h1",null,"Splat"),r.a.createElement("p",null,"Quick description or smth, warning about login redirect"),r.a.createElement("h2",null,"Known ",r.a.createElement("i",null,"FeAtUrEs")),r.a.createElement("ul",null,r.a.createElement("li",null,"If the first song is shorter than the poll time (10 seconds), the album may not get enqueued"),r.a.createElement("li",null,"On page reload songs get enqueued another time"),r.a.createElement("li",null,"Everything is done from the browser, so this site has to stay open."),r.a.createElement("li",null,"Token sometimes doesn't auto refresh, in case of errors close/open page")),(null===n||void 0===n?void 0:n.access_token)?r.a.createElement("button",{onClick:function(){return a.push("/dashboard")}},"Go to app"):r.a.createElement("button",{onClick:function(){return t()}},"Log in to Spotify"))},O=function(e){var t=e.children,n=e.loginPage,a=Object(p.useAuth)(),o=a.userData,u=a.loading,c=Object(m.e)();return(null===o||void 0===o?void 0:o.access_token)||u||c.replace(n),u?null:r.a.createElement(r.a.Fragment,null,t)},y=function(){var e=Object(m.e)();return r.a.createElement("div",{className:"App"},r.a.createElement(p.AuthProvider,{userManager:new p.UserManager({authority:"https://accounts.spotify.com/",metadata:{authorization_endpoint:"https://accounts.spotify.com/authorize",token_endpoint:"https://accounts.spotify.com/api/token"},response_type:"code",client_id:"908eaf93b654400f95f7bb221967a65b",redirect_uri:"https://briaoeuidhtns.github.io/splat/auth",scope:"user-read-playback-state user-modify-playback-state"}),autoSignIn:!1,automaticSilentRenew:!0,onSignIn:function(t){return e.replace("/dashboard",t)}},r.a.createElement(m.a,{exact:!0,path:"/"},r.a.createElement(k,null)),r.a.createElement(m.a,{path:"/dashboard"},r.a.createElement(O,{loginPage:"/"},r.a.createElement(E,null)))))},j=n(11);u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j.a,{basename:"/splat"},r.a.createElement(y,null))),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.e7380f7a.chunk.js.map